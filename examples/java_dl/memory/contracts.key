\javaSource ".";

\contracts{

Memorystack_push{
  

  \programVariables{
	javax.realtime.MemoryStack result,s;
	javax.realtime.ScopedMemory m;
  }

    true ->
	\<{result=s.push(m)@javax.realtime.MemoryStack;}\>
		(!(result=null) & result.stack.length=s.stack.length+1 &
                result.stack[s.stack.length]=m & (\forall int i; (i>=0 &
                i<s.stack.length -> result.stack[i]=s.stack[i])) &
		result=javax.realtime.MemoryStack::<get>(
			javax.realtime.MemoryStack::<nextToCreate>@pre) &
		javax.realtime.MemoryStack.<nextToCreate>=
			javax.realtime.MemoryStack::<nextToCreate>@pre+1 &
		result.stack = javax.realtime.ScopedMemory[]::<get>(
			javax.realtime.ScopedMemory[]::<nextToCreate>@pre) &
		javax.realtime.ScopedMemory[].<nextToCreate>=
			javax.realtime.ScopedMemory::<nextToCreate>@pre+1 &
		result.memoryArea = m.memoryArea &
		outerScope(s, result))
    
	\modifies {javax.realtime.ScopedMemory[].<nextToCreate>, 
	       javax.realtime.ScopedMemory[]::<get>(
			javax.realtime.ScopedMemory[].<nextToCreate>).<created>,
		javax.realtime.MemoryStack.<nextToCreate>, 
	       	javax.realtime.MemoryStack::<get>(
			javax.realtime.MemoryStack.<nextToCreate>).<created>}
};




}

\chooseContract